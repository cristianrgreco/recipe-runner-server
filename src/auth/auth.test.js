const {isTokenValid} = require('./auth');

describe('auth', () => {

    it('should return true if token is valid', async () => {
        const jwt = 'eyJraWQiOiJpeDdnS2hPWlJiYm84cHpIU011RGYzWEJqdnh1OWphUmJPZ25iSURTYkRZPSIsImFsZyI6IlJTMjU2In0.eyJzdWIiOiJkZjIyYWIxOC0zNmRmLTQ5YmYtYTc2My1hOTlmZmFmMmU0YTQiLCJldmVudF9pZCI6ImIwMzQ3YzE1LTNlYWMtNDg4Yy04MjBhLTZiNTNmMzQyMGY2MSIsInRva2VuX3VzZSI6ImFjY2VzcyIsInNjb3BlIjoiYXdzLmNvZ25pdG8uc2lnbmluLnVzZXIuYWRtaW4iLCJhdXRoX3RpbWUiOjE1NzM1NTA3MjcsImlzcyI6Imh0dHBzOlwvXC9jb2duaXRvLWlkcC5ldS13ZXN0LTIuYW1hem9uYXdzLmNvbVwvZXUtd2VzdC0yX0lndjNDWW5PeiIsImV4cCI6MTU3MzU1ODEwNSwiaWF0IjoxNTczNTU0NTA1LCJqdGkiOiJlNGRmMGVlZi1hYTgxLTRlNGYtYTIwYy03OGNmZDlmMTU2NzAiLCJjbGllbnRfaWQiOiI0Yjk0bG9uZTFyY3E0ZzZlZmp2bnFhdGlkayIsInVzZXJuYW1lIjoiY3Jpc3RpYW5yZ3JlY29AZ21haWwuY29tIn0.qHwQTfk7oNLVWsyJvcGdUifRGwVmkYe3kIJC2cmarMRDf1YNwKd3UseNpEAq2CawhzpyoXWJcEUg6PhUBfFhut07osBA-ucKAmryn9EGwOB7Au2BbezYM7JGz2FRSxTrBA7xcvRE_pmS9uAoRO6gR7n9yacqbJOhh7XsvFhRhi89cosCvwMqihrnZ2SDfxPbaGEk7HoUBKFBsIjVeAXKmgmWRZiGlIHzj8zFk1VT4g6NkfHoJQI8jeGUOg2PW4fvKczuBCuWiig5BHvjjG5K76YLNjigsAaPVsWcy3FJjEM4cWPg6-MElEgQ9whl4rPc6lVbsc3hkLCHFlwekmFesg';
        expect(await isTokenValid(jwt)).toBe(true);
    });

    it('should return false when signature is invalid', async () => {
        const jwt = 'fyJraWQiOiJpeDdnS2hPWlJiYm84cHpIU011RGYzWEJqdnh1OWphUmJPZ25iSURTYkRZPSIsImFsZyI6IlJTMjU2In0.eyJzdWIiOiJkZjIyYWIxOC0zNmRmLTQ5YmYtYTc2My1hOTlmZmFmMmU0YTQiLCJldmVudF9pZCI6ImIwMzQ3YzE1LTNlYWMtNDg4Yy04MjBhLTZiNTNmMzQyMGY2MSIsInRva2VuX3VzZSI6ImFjY2VzcyIsInNjb3BlIjoiYXdzLmNvZ25pdG8uc2lnbmluLnVzZXIuYWRtaW4iLCJhdXRoX3RpbWUiOjE1NzM1NTA3MjcsImlzcyI6Imh0dHBzOlwvXC9jb2duaXRvLWlkcC5ldS13ZXN0LTIuYW1hem9uYXdzLmNvbVwvZXUtd2VzdC0yX0lndjNDWW5PeiIsImV4cCI6MTU3MzU1NDMyNywiaWF0IjoxNTczNTUwNzI3LCJqdGkiOiI5NmY4YzNjOC0zNjk5LTRhNTEtYTg0YS1kNjI4YmFlOTIwOGIiLCJjbGllbnRfaWQiOiI0Yjk0bG9uZTFyY3E0ZzZlZmp2bnFhdGlkayIsInVzZXJuYW1lIjoiY3Jpc3RpYW5yZ3JlY29AZ21haWwuY29tIn0.cK882HU9a2R6kbTil0U2ncN3r_gJcnMRueV8VRP_4IZgvXbvegEAx48_DonyieUJb4Q9cTaRCs163D9r_N2s2MVjHxUrAA5ySVqttiAAFKb0SE7DwDRyvBU7WsOUPjkxWyKpfSD6hvQrvVqF8qKO0gVjOkm9EAJ1zO7u6R9McWeXG3SwDhpHONP1GZMlh55st4i2_FMChHlVpnSmxFKgxvnwQjzea-t3pTwAj3h8LuWglTe2gCwSOMWMAmeViY5Neo9UKd72P1gvHSIjdMytLGy2NNIZ7k679_eW6g20HIwwNEUqEjKYO1wkoX0se03wBLYOWbxL58sNgHipmHeXuQ';
        expect(await isTokenValid(jwt)).toBe(false);
    });
});
